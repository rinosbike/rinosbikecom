<!-- sections/gravel-comparison.liquid -->
<style>
  .gravel-comparison {
    padding: 0;
    background: #ffffff;
    font-family: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  }

  .gravel-comparison-container {
    max-width: 1400px;
    margin: 0 auto;
  }

  /* Desktop Table View */
  .comparison-wrapper {
    overflow-x: auto;
    background: white;
  }

  .comparison-table {
    width: 100%;
    border-collapse: collapse;
    min-width: 1200px;
  }

  .bike-header {
    background: #fafafa;
    border-bottom: 1px solid #e8e8e8;
  }

  .bike-header th {
    padding: 50px 30px 40px;
    text-align: center;
    border-right: 1px solid #e8e8e8;
    position: relative;
    vertical-align: top;
  }

  .bike-header th:last-child {
    border-right: none;
  }

  .bike-header th:first-child {
    background: #ffffff;
    border-right: 1px solid #e8e8e8;
    padding: 0;
  }

  .featured-bike {
    background: {{ section.settings.featured_bg_color }};
    color: {{ section.settings.featured_text_color }};
    position: relative;
  }

  .premium-bike {
    background: {{ section.settings.premium_bg_color }};
    color: {{ section.settings.premium_text_color }};
    position: relative;
  }

  .bike-name {
    font-size: 1.4rem;
    font-weight: 600;
    color: #1d1d1f;
    margin-bottom: 12px;
    text-transform: uppercase;
    letter-spacing: 0.02em;
  }

  .featured-bike .bike-name,
  .premium-bike .bike-name {
    color: #ffffff;
  }

  .bike-description {
    font-size: 1rem;
    color: #86868b;
    line-height: 1.4;
    font-weight: 400;
    margin-bottom: 24px;
  }

  .featured-bike .bike-description,
  .premium-bike .bike-description {
    color: #a1a1a6;
  }

  .discover-link {
    font-size: 0.95rem;
    color: #0066cc;
    text-decoration: none;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-bottom: 1px solid transparent;
    transition: all 0.2s ease;
  }

  .discover-link:hover {
    border-bottom-color: #0066cc;
  }

  .featured-bike .discover-link,
  .premium-bike .discover-link {
    color: #ffffff;
  }

  .featured-bike .discover-link:hover,
  .premium-bike .discover-link:hover {
    border-bottom-color: #ffffff;
  }

  .spec-row {
    border-bottom: 1px solid #f5f5f7;
  }

  .spec-row:last-child {
    border-bottom: none;
  }

  .spec-label {
    padding: 24px 30px;
    font-weight: 500;
    color: #1d1d1f;
    background: #fafafa;
    border-right: 1px solid #e8e8e8;
    font-size: 1rem;
    text-transform: uppercase;
    letter-spacing: 0.3px;
    width: 180px;
  }

  .spec-value {
    padding: 24px 30px;
    color: #1d1d1f;
    font-weight: 400;
    border-right: 1px solid #f5f5f7;
    font-size: 1.05rem;
    text-align: center;
    background: #ffffff;
  }

  .spec-value:last-child {
    border-right: none;
  }

  .featured-spec {
    background: {{ section.settings.featured_bg_color }};
    color: {{ section.settings.featured_text_color }};
    font-weight: 500;
    border-left: 1px solid #2a2a2a;
    border-right: 1px solid #2a2a2a;
  }

  .premium-spec {
    background: {{ section.settings.premium_bg_color }};
    color: {{ section.settings.premium_text_color }};
    font-weight: 500;
  }

  .featured-spec:last-child,
  .premium-spec:last-child {
    border-right: none;
  }

  /* Mobile Accordion View */
  .mobile-accordion {
    display: none;
    padding: 0;
  }

  .mobile-accordion-item {
    border-bottom: 1px solid #e8e8e8;
  }

  .mobile-accordion-item:last-child {
    border-bottom: none;
  }

  .mobile-accordion-header {
    padding: 30px 20px;
    background: #fafafa;
    cursor: pointer;
    position: relative;
    transition: all 0.3s ease;
  }

  .mobile-accordion-header:active {
    background: #f0f0f0;
  }

  .mobile-accordion-header.featured {
    background: {{ section.settings.featured_bg_color }};
    color: {{ section.settings.featured_text_color }};
  }

  .mobile-accordion-header.premium {
    background: {{ section.settings.premium_bg_color }};
    color: {{ section.settings.premium_text_color }};
  }

  .mobile-bike-name {
    font-size: 1.3rem;
    font-weight: 600;
    color: #1d1d1f;
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 0.02em;
  }

  .mobile-accordion-header.featured .mobile-bike-name,
  .mobile-accordion-header.premium .mobile-bike-name {
    color: #ffffff;
  }

  .mobile-bike-description {
    font-size: 0.9rem;
    color: #86868b;
    line-height: 1.4;
    font-weight: 400;
    margin-bottom: 12px;
  }

  .mobile-accordion-header.featured .mobile-bike-description,
  .mobile-accordion-header.premium .mobile-bike-description {
    color: #a1a1a6;
  }

  .mobile-discover-link {
    font-size: 0.8rem;
    color: #0066cc;
    text-decoration: none;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .mobile-accordion-header.featured .mobile-discover-link,
  .mobile-accordion-header.premium .mobile-discover-link {
    color: #ffffff;
  }

  .mobile-accordion-toggle {
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.2rem;
    color: #86868b;
    transition: transform 0.3s ease;
    pointer-events: none;
  }

  .mobile-accordion-header.featured .mobile-accordion-toggle,
  .mobile-accordion-header.premium .mobile-accordion-toggle {
    color: #ffffff;
  }

  .mobile-accordion-toggle.active {
    transform: translateY(-50%) rotate(180deg);
  }

  .mobile-accordion-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
    background: #ffffff;
  }

  .mobile-accordion-content.active {
    max-height: 500px;
  }

  .mobile-specs {
    padding: 20px;
  }

  .mobile-spec-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 0;
    border-bottom: 1px solid #f5f5f7;
  }

  .mobile-spec-item:last-child {
    border-bottom: none;
  }

  .mobile-spec-label {
    font-weight: 500;
    color: #1d1d1f;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.3px;
  }

  .mobile-spec-value {
    font-weight: 400;
    color: #1d1d1f;
    font-size: 0.95rem;
    text-align: right;
  }

  /* Responsive breakpoints */
  @media (max-width: 768px) {
    .comparison-wrapper {
      display: none;
    }

    .mobile-accordion {
      display: block;
    }
  }

  @media (max-width: 480px) {
    .mobile-accordion-header {
      padding: 25px 15px;
    }

    .mobile-bike-name {
      font-size: 1.1rem;
    }

    .mobile-bike-description {
      font-size: 0.8rem;
    }

    .mobile-discover-link {
      font-size: 0.75rem;
    }
  }

  /* Tablet */
  @media (max-width: 1024px) and (min-width: 769px) {
    .comparison-table {
      min-width: 1000px;
    }
    
    .bike-header th {
      padding: 40px 25px 35px;
    }
  }

  /* Accessibility */
  @media (prefers-reduced-motion: reduce) {
    .discover-link,
    .mobile-accordion-header,
    .mobile-accordion-content,
    .mobile-accordion-toggle {
      transition: none;
    }
  }
</style>

<section class="gravel-comparison">
  <div class="gravel-comparison-container">
    
    <!-- Desktop Table View -->
    <div class="comparison-wrapper">
      <table class="comparison-table">
        <thead class="bike-header">
          <tr>
            <th></th>
            {% for block in section.blocks %}
              {% if block.type == 'bike_column' %}
                <th class="{% if block.settings.is_featured %}featured-bike{% elsif block.settings.is_premium %}premium-bike{% endif %}">
                  <div class="bike-name">{{ block.settings.bike_name }}</div>
                  <div class="bike-description">{{ block.settings.bike_description }}</div>
                  {% if block.settings.product_link != blank %}
                    <a href="{{ block.settings.product_link }}" class="discover-link">{{ block.settings.link_text | default: 'Discover More' }}</a>
                  {% endif %}
                </th>
              {% endif %}
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for spec_block in section.blocks %}
            {% if spec_block.type == 'specification_row' %}
              <tr class="spec-row">
                <td class="spec-label">{{ spec_block.settings.spec_name }}</td>
                {% assign spec_values = spec_block.settings.spec_values | split: ',' %}
                {% for value in spec_values %}
                  {% assign bike_index = forloop.index0 %}
                  {% assign is_featured = false %}
                  {% assign is_premium = false %}
                  
                  {% for block in section.blocks %}
                    {% if block.type == 'bike_column' %}
                      {% assign current_index = forloop.index0 %}
                      {% if current_index == bike_index %}
                        {% if block.settings.is_featured %}
                          {% assign is_featured = true %}
                        {% elsif block.settings.is_premium %}
                          {% assign is_premium = true %}
                        {% endif %}
                      {% endif %}
                    {% endif %}
                  {% endfor %}
                  
                  <td class="spec-value {% if is_featured %}featured-spec{% elsif is_premium %}premium-spec{% endif %}">
                    {{ value | strip }}
                  </td>
                {% endfor %}
              </tr>
            {% endif %}
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Mobile Accordion View -->
    <div class="mobile-accordion">
      {% for block in section.blocks %}
        {% if block.type == 'bike_column' %}
          {% assign bike_index = forloop.index0 %}
          <div class="mobile-accordion-item">
            <div class="mobile-accordion-header {% if block.settings.is_featured %}featured{% elsif block.settings.is_premium %}premium{% endif %}">
              <div class="mobile-bike-name">{{ block.settings.bike_name }}</div>
              <div class="mobile-bike-description">{{ block.settings.bike_description }}</div>
              {% if block.settings.product_link != blank %}
                <a href="{{ block.settings.product_link }}" class="mobile-discover-link">{{ block.settings.link_text | default: 'Discover More' }}</a>
              {% endif %}
              <span class="mobile-accordion-toggle">â†“</span>
            </div>
            <div class="mobile-accordion-content">
              <div class="mobile-specs">
                {% for spec_block in section.blocks %}
                  {% if spec_block.type == 'specification_row' %}
                    {% assign spec_values = spec_block.settings.spec_values | split: ',' %}
                    <div class="mobile-spec-item">
                      <span class="mobile-spec-label">{{ spec_block.settings.spec_name }}</span>
                      <span class="mobile-spec-value">{{ spec_values[bike_index] | strip | default: '-' }}</span>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

<script>
// Mobile accordion functionality
document.addEventListener('DOMContentLoaded', function() {
  // Handle accordion toggle
  document.querySelectorAll('.mobile-accordion-header').forEach(function(header) {
    header.addEventListener('click', function(e) {
      // Don't toggle if clicking on discover link
      if (e.target.classList.contains('mobile-discover-link')) {
        return;
      }
      
      const content = this.nextElementSibling;
      const toggle = this.querySelector('.mobile-accordion-toggle');
      
      // Close all other accordions
      document.querySelectorAll('.mobile-accordion-content').forEach(function(item) {
        if (item !== content) {
          item.classList.remove('active');
          const otherToggle = item.previousElementSibling.querySelector('.mobile-accordion-toggle');
          if (otherToggle) {
            otherToggle.classList.remove('active');
          }
        }
      });
      
      // Toggle current accordion
      content.classList.toggle('active');
      if (toggle) {
        toggle.classList.toggle('active');
      }
    });
  });
});
</script>

{% schema %}
{
  "name": "Gravel Bike Comparison",
  "settings": [
    {
      "type": "color",
      "id": "featured_bg_color",
      "label": "Featured Background Color",
      "default": "#2C2C2C"
    },
    {
      "type": "color",
      "id": "featured_text_color",
      "label": "Featured Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "premium_bg_color",
      "label": "Premium Background Color",
      "default": "#8B4513"
    },
    {
      "type": "color",
      "id": "premium_text_color",
      "label": "Premium Text Color",
      "default": "#ffffff"
    }
  ],
  "blocks": [
    {
      "type": "bike_column",
      "name": "Bike Model",
      "settings": [
        {
          "type": "text",
          "id": "bike_name",
          "label": "Bike Name",
          "default": "Sandman 4"
        },
        {
          "type": "text",
          "id": "bike_description",
          "label": "Bike Description",
          "default": "Carbon. Performance. Adventure."
        },
        {
          "type": "url",
          "id": "product_link",
          "label": "Product Link"
        },
        {
          "type": "text",
          "id": "link_text",
          "label": "Link Text",
          "default": "Discover More"
        },
        {
          "type": "checkbox",
          "id": "is_featured",
          "label": "Featured Model",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "is_premium",
          "label": "Premium Model",
          "default": false
        }
      ]
    },
    {
      "type": "specification_row",
      "name": "Specification",
      "settings": [
        {
          "type": "text",
          "id": "spec_name",
          "label": "Specification Name",
          "default": "Weight"
        },
        {
          "type": "text",
          "id": "spec_values",
          "label": "Specification Values",
          "info": "Comma-separated values for each bike model in order",
          "default": "10.5kg, 10kg, 9.8kg, 9.5kg, 9.8kg, 8.7kg, 9.4kg"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Gravel Bike Comparison",
      "blocks": [
        {
          "type": "bike_column",
          "settings": {
            "bike_name": "Sandman 1",
            "bike_description": "Entry. Reliable. Adventure.",
            "product_link": "/products/sandman-1",
            "link_text": "Discover More"
          }
        },
        {
          "type": "bike_column",
          "settings": {
            "bike_name": "Sandman 3",
            "bike_description": "Value. Performance. Versatile.",
            "product_link": "/products/sandman-3",
            "link_text": "Discover More"
          }
        },
        {
          "type": "bike_column",
          "settings": {
            "bike_name": "Sandman 4",
            "bike_description": "Carbon. Made for Gravel.",
            "product_link": "/products/sandman-4",
            "link_text": "Discover More",
            "is_featured": true
          }
        },
        {
          "type": "bike_column",
          "settings": {
            "bike_name": "Sandman 5",
            "bike_description": "Advanced. Lightweight. Fast.",
            "product_link": "/products/sandman-5",
            "link_text": "Discover More"
          }
        },
        {
          "type": "bike_column",
          "settings": {
            "bike_name": "Sandman 6",
            "bike_description": "GRX600. Premium. Performance.",
            "product_link": "/products/sandman-6",
            "link_text": "Discover More"
          }
        },
        {
          "type": "bike_column",
          "settings": {
            "bike_name": "Sandman 7",
            "bike_description": "Elite. Carbon. Di2.",
            "product_link": "/products/sandman-7",
            "link_text": "Discover More"
          }
        },
        {
          "type": "bike_column",
          "settings": {
            "bike_name": "Sandman 8",
            "bike_description": "Carbon. Precision. Adventure. Electronic.",
            "product_link": "/products/sandman-8",
            "link_text": "Discover More",
            "is_premium": true
          }
        },
        {
          "type": "specification_row",
          "settings": {
            "spec_name": "Weight",
            "spec_values": "10.5kg, 10kg, 9.8kg, 9.5kg, 9.8kg, 8.7kg, 9.4kg"
          }
        },
        {
          "type": "specification_row",
          "settings": {
            "spec_name": "Gear Shifter",
            "spec_values": "Shimano Claris, Shimano Sora, Shimano GRX400, Shimano GRX600, Shimano GRX600, Shimano GRX810 Di2, Shimano 105 Di2"
          }
        },
        {
          "type": "specification_row",
          "settings": {
            "spec_name": "Gears",
            "spec_values": "2x8, 2x9, 2x10, 2x11, 2x11, 2x11, 2x12"
          }
        },
        {
          "type": "specification_row",
          "settings": {
            "spec_name": "Frame",
            "spec_values": "Aluminum, Aluminum, Toray T800 Carbon, Toray T800 Carbon, Toray T800 Carbon, Toray T900 Carbon, Toray T800 Carbon"
          }
        },
        {
          "type": "specification_row",
          "settings": {
            "spec_name": "Frame Sizes",
            "spec_values": "XS-XL, XS-XL, XS-XL, XS-XL, XS-XL, XS-XL, XS-L"
          }
        },
        {
          "type": "specification_row",
          "settings": {
            "spec_name": "Brakes",
            "spec_values": "Mechanical Disc, Mechanical Disc, Hydraulic Disc, Hydraulic Disc, Hydraulic Disc, Hydraulic Disc, Hydraulic Disc"
          }
        },
        {
          "type": "specification_row",
          "settings": {
            "spec_name": "Wheel Size",
            "spec_values": "700c, 700c, 700c, 700c, 700c, 700c, 700c"
          }
        },
        {
          "type": "specification_row",
          "settings": {
            "spec_name": "Rims",
            "spec_values": "30mm Alloy, 30mm Alloy, 38mm Alloy, 38mm Alloy, 38mm Alloy, 40mm Carbon, 40mm Carbon"
          }
        }
      ]
    }
  ]
}
{% endschema %}